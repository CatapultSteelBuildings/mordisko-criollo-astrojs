---
import { Image } from 'astro:assets';

import Whatsapp from '../ui/buttons/Whatsapp.button.astro';

import { getLangFromUrl, useTranslations } from '@i18n/utils';
import { t } from '@i18n/ui';

import hero1 from '@assets/images/hero/empanada-01.webp';
import hero2 from '@assets/images/hero/empanada-02.webp';
import hero3 from '@assets/images/hero/empanada-03.webp';
import hero4 from '@assets/images/hero/empanada-04.webp';

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
const images = [hero1, hero2, hero3, hero4];
---

<section class="Hero-Home">
  <div>
    <Image
      src={hero1}
      alt={`Steel Building Hero`}
      widths={[360, 640, 768, 1200, 1920]}
      sizes="(max-width: 360px) 100vw, (max-width: 640px) 100vw, (max-width: 768px) 100vw, (max-width: 1024px) 1200px, 1920px"
      loading="eager"
      quality={1}
      fetchpriority="high"
      class="h-auto max-h-[80vh] object-cover opacity-0 max-sm:min-h-[230px]"
      decoding="async"
    />
  </div>
  {
    images.map((img, index) => (
      <div class="hero-slide absolute inset-0">
        <Image
          src={img}
          alt={`Steel Building Hero ${index + 1}`}
          widths={[360, 640, 768, 1200, 1920]}
          sizes="(max-width: 360px) 100vw, (max-width: 640px) 100vw, (max-width: 768px) 100vw, (max-width: 1024px) 1200px, 1920px"
          loading={index === 0 ? 'eager' : 'lazy'}
          fetchpriority={index === 0 ? 'high' : undefined}
          class="h-auto max-h-[80vh] w-full object-cover max-sm:min-h-[230px]"
          decoding="async"
        />
      </div>
    ))
  }

  <!-- Texto fijo centrado -->
  <div
    class="absolute inset-0 z-10 flex flex-col items-center justify-center gap-y-3 px-4 text-center text-white">
    <h1
      class="max-w-3xl text-3xl leading-tight font-bold text-(--white) text-shadow-[0_0_1px_var(--secondary)] md:text-4xl lg:text-5xl">
      {t('hero.title')}
    </h1>
    <h3 class="hidden text-lg italic opacity-90 md:text-xl">
      {t('hero.subtitle')}
    </h3>
    <Whatsapp />
  </div>
</section>

<style>
  @reference "tailwindcss";
  .Hero-Home {
    @apply relative max-h-[800px] w-full overflow-hidden max-sm:min-h-[230px];
  }

  .hero-slide {
    position: absolute;
    inset: 0;
    opacity: 0;
    animation: fade 16s infinite;
  }

  .hero-slide:nth-child(1) {
    animation-delay: 0s;
  }
  .hero-slide:nth-child(2) {
    animation-delay: 4s;
  }
  .hero-slide:nth-child(3) {
    animation-delay: 8s;
  }
  .hero-slide:nth-child(4) {
    animation-delay: 12s;
  }

  @keyframes fade {
    0%,
    100% {
      opacity: 0;
    }
    8.33%,
    91.66% {
      opacity: 1;
    }
  }
</style>
